<!doctype html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FMCYFTFPEL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-FMCYFTFPEL');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9715826188316382"
        crossorigin="anonymous"></script>

    <link rel="manifest" href="/manifest.json" />

    <meta charset="utf-8">
    <title>QR Maker | UwU Apps</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Your offline QR Maker with widget and sharing options.">

    <meta property="og:type" content="website">
    <meta property="og:title" content="QR Maker | UwU Apps" />
    <meta property="og:site_name" content="UwU Apps" />
    <meta property="og:description" content="Your offline QR Maker with widget and sharing options." />

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jua">
    <link rel="stylesheet" href="/style.css">

    <!-- Embed Image -->
    <link rel="apple-touch-icon" href="/qrmakericon1.png">
    <link rel="icon" href="/favicon.ico">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image:src" content="/qrmakericon1.png">
    <meta property="og:image" content="/qrmakericon1.png" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script defer="" src="https://use.fontawesome.com/releases/v6.5.2/js/all.js"></script>
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js" as="script" />
</head>

<body>
    <header class="appbar">
        <div class="logo-dot"></div>
        <h1>QR Maker</h1>
        <button id="installBtn" class="btn ghost" aria-label="Install">Install</button>
    </header>

    <main class="wrap">
        <section class="card">
            <h2>Create QR</h2>
            <p class="hint">Paste or share your text / link.</p>

            <label for="qrtext" class="visually-hidden">QR text</label>
            <textarea id="qrtext" rows="4" placeholder="Type or share something…"></textarea>

            <div class="row">
                <label class="chk">
                    <input type="checkbox" id="apiToggle" checked />
                    <span>Use QRServer PNG (online)</span>
                </label>
                <label class="chk">
                    <input type="checkbox" id="marginToggle" checked />
                    <span>Quiet zone</span>
                </label>
                <label class="sel">
                    ECC:
                    <select id="ecc">
                        <option value="M">M (15%)</option>
                        <option value="L">L (7%)</option>
                        <option value="Q">Q (25%)</option>
                        <option value="H">H (30%)</option>
                    </select>
                </label>
                <label class="sel">
                    Size:
                    <select id="size">
                        <option>256</option>
                        <option selected>512</option>
                        <option>768</option>
                        <option>1024</option>
                    </select>px
                </label>
            </div>

            <div class="preview">
                <div class="pane">
                    <h3>Preview</h3>
                    <div id="preview"></div>
                </div>
                <div class="pane">
                    <h3>PNG</h3>
                    <img id="apiImg" alt="QR PNG from API" />
                </div>
            </div>

            <div class="row actions">
                <button id="downloadSvg" class="btn">Download SVG</button>
                <button id="downloadPng" class="btn">Download PNG</button>
                <button id="shareOut" class="btn ghost">Share QR</button>
            </div>
        </section>
    </main>

    <footer class="footer">
        <small>Made with ❤️ by Augy.</small>
    </footer>

    <script>
        // PWA install prompt
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'inline-flex';
        });
        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            await deferredPrompt.userChoice;
            deferredPrompt = null;
            installBtn.style.display = 'none';
        });

        // Register SW
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('/sw.js');

        // Load QR encoder (cached by SW for offline)
        const lib = document.createElement('script');
        lib.src = 'https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js';
        document.head.appendChild(lib);
    </script>

    <script src="/script.js"></script>
</body>

</html>